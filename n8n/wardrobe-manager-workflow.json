{
  "name": "Wardrobe Manager Backend",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "auth/register",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "reg-webhook",
      "name": "Register Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [260, 100],
      "webhookId": "wm-register"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "auth/login",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "login-webhook",
      "name": "Login Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [260, 260],
      "webhookId": "wm-login"
    },
    {
      "parameters": {
        "httpMethod": "GET",
        "path": "auth/me",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "me-webhook",
      "name": "Me Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [260, 420],
      "webhookId": "wm-me"
    },
    {
      "parameters": {
        "httpMethod": "GET",
        "path": "garments",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "get-garments-webhook",
      "name": "Get Garments Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [260, 580],
      "webhookId": "wm-garments-get"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "garments",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "create-garment-webhook",
      "name": "Create Garment Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [260, 740],
      "webhookId": "wm-garments-create"
    },
    {
      "parameters": {
        "httpMethod": "DELETE",
        "path": "garments/:id",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "delete-garment-webhook",
      "name": "Delete Garment Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [260, 900],
      "webhookId": "wm-garments-delete"
    },
    {
      "parameters": {
        "httpMethod": "GET",
        "path": "outfits",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "get-outfits-webhook",
      "name": "Get Outfits Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [260, 1060],
      "webhookId": "wm-outfits-get"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "outfits",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "create-outfit-webhook",
      "name": "Create Outfit Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [260, 1220],
      "webhookId": "wm-outfits-create"
    },
    {
      "parameters": {
        "httpMethod": "DELETE",
        "path": "outfits/:id",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "delete-outfit-webhook",
      "name": "Delete Outfit Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [260, 1380],
      "webhookId": "wm-outfits-delete"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "ai/chat",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "ai-chat-webhook",
      "name": "AI Chat Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [260, 1540],
      "webhookId": "wm-ai-chat"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "ai/suggest-outfit",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "ai-suggest-webhook",
      "name": "AI Suggest Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [260, 1700],
      "webhookId": "wm-ai-suggest"
    },
    {
      "parameters": {
        "jsCode": "const body = $input.first().json.body || {};\n\nif (!body.email || !body.password) {\n  return [{ json: { success: false, error: 'Email –∏ –ø–∞—Ä–æ–ª–∞ —Å–∞ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏' } }];\n}\n\nif (body.password.length < 6) {\n  return [{ json: { success: false, error: '–ü–∞—Ä–æ–ª–∞—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –µ –ø–æ–Ω–µ 6 —Å–∏–º–≤–æ–ª–∞' } }];\n}\n\nconst crypto = require('crypto');\nconst hash = crypto.createHash('md5').update(body.email.toLowerCase()).digest('hex');\nconst visibleChars = body.email.substring(0, 2).toUpperCase();\nconst userId = visibleChars + hash.substring(0, 10);\nconst now = Date.now();\n\nconst accessToken = Buffer.from(JSON.stringify({\n  id: userId,\n  email: body.email,\n  iat: now,\n  exp: now + 86400000\n})).toString('base64');\n\nconst refreshToken = Buffer.from(JSON.stringify({\n  id: userId,\n  type: 'refresh',\n  iat: now,\n  exp: now + 604800000\n})).toString('base64');\n\nreturn [{\n  json: {\n    success: true,\n    user: {\n      id: userId,\n      email: body.email,\n      name: body.name || body.email.split('@')[0],\n      gender: body.gender || null,\n      createdAt: new Date().toISOString()\n    },\n    accessToken,\n    refreshToken\n  }\n}];"
      },
      "id": "process-register",
      "name": "Process Register",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 100]
    },
    {
      "parameters": {
        "jsCode": "const body = $input.first().json.body || {};\n\nif (!body.email || !body.password) {\n  return [{ json: { success: false, error: 'Email –∏ –ø–∞—Ä–æ–ª–∞ —Å–∞ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏' } }];\n}\n\nconst crypto = require('crypto');\nconst hash = crypto.createHash('md5').update(body.email.toLowerCase()).digest('hex');\nconst visibleChars = body.email.substring(0, 2).toUpperCase();\nconst userId = visibleChars + hash.substring(0, 10);\nconst now = Date.now();\n\nconst accessToken = Buffer.from(JSON.stringify({\n  id: userId,\n  email: body.email,\n  iat: now,\n  exp: now + 86400000\n})).toString('base64');\n\nconst refreshToken = Buffer.from(JSON.stringify({\n  id: userId,\n  type: 'refresh',\n  iat: now,\n  exp: now + 604800000\n})).toString('base64');\n\nreturn [{\n  json: {\n    success: true,\n    user: {\n      id: userId,\n      email: body.email,\n      name: body.email.split('@')[0]\n    },\n    accessToken,\n    refreshToken\n  }\n}];"
      },
      "id": "process-login",
      "name": "Process Login",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 260]
    },
    {
      "parameters": {
        "jsCode": "const headers = $input.first().json.headers || {};\nconst authHeader = headers.authorization || headers.Authorization || '';\n\nif (!authHeader.startsWith('Bearer ')) {\n  return [{ json: { success: false, error: '–ù–µ–æ—Ç–æ—Ä–∏–∑–∏—Ä–∞–Ω –¥–æ—Å—Ç—ä–ø' } }];\n}\n\ntry {\n  const token = authHeader.replace('Bearer ', '');\n  const decoded = JSON.parse(Buffer.from(token, 'base64').toString('utf8'));\n  \n  if (decoded.exp && decoded.exp < Date.now()) {\n    return [{ json: { success: false, error: '–¢–æ–∫–µ–Ω—ä—Ç –µ –∏–∑—Ç–µ–∫—ä–ª' } }];\n  }\n  \n  return [{\n    json: {\n      success: true,\n      id: decoded.id,\n      email: decoded.email,\n      name: decoded.email ? decoded.email.split('@')[0] : 'User'\n    }\n  }];\n} catch (e) {\n  return [{ json: { success: false, error: '–ù–µ–≤–∞–ª–∏–¥–µ–Ω —Ç–æ–∫–µ–Ω' } }];\n}"
      },
      "id": "process-me",
      "name": "Process Me",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 420]
    },
    {
      "parameters": {
        "jsCode": "// In-memory garments storage (would be database in production)\nconst garments = [\n  { id: 'g1', name: '–ë—è–ª–∞ —Ä–∏–∑–∞', category: 'shirt', primaryColor: 'white', secondaryColor: null, season: 'all_year', style: 'business_casual', material: 'cotton', brand: null, imageUrl: null, status: 'active', createdAt: '2024-01-01T00:00:00Z' },\n  { id: 'g2', name: '–°–∏–Ω–∏ –¥—ä–Ω–∫–∏', category: 'pants', primaryColor: 'blue', secondaryColor: null, season: 'all_year', style: 'casual', material: 'denim', brand: 'Levi\\'s', imageUrl: null, status: 'active', createdAt: '2024-01-02T00:00:00Z' },\n  { id: 'g3', name: '–ß–µ—Ä–Ω–æ —Å–∞–∫–æ', category: 'jacket', primaryColor: 'black', secondaryColor: null, season: 'fall', style: 'formal', material: 'wool', brand: null, imageUrl: null, status: 'active', createdAt: '2024-01-03T00:00:00Z' },\n  { id: 'g4', name: '–ë—è–ª–∞ —Ç–µ–Ω–∏—Å–∫–∞', category: 'tshirt', primaryColor: 'white', secondaryColor: null, season: 'summer', style: 'casual', material: 'cotton', brand: null, imageUrl: null, status: 'active', createdAt: '2024-01-04T00:00:00Z' },\n  { id: 'g5', name: '–ß–µ—Ä–Ω–∏ –ø–∞–Ω—Ç–∞–ª–æ–Ω–∏', category: 'pants', primaryColor: 'black', secondaryColor: null, season: 'all_year', style: 'formal', material: 'polyester', brand: null, imageUrl: null, status: 'active', createdAt: '2024-01-05T00:00:00Z' },\n  { id: 'g6', name: '–°–∏–Ω—è —Ä–∏–∑–∞', category: 'shirt', primaryColor: 'blue', secondaryColor: null, season: 'all_year', style: 'business_casual', material: 'cotton', brand: null, imageUrl: null, status: 'active', createdAt: '2024-01-06T00:00:00Z' },\n  { id: 'g7', name: '–ë–µ–∂–æ–≤–æ –ø–∞–ª—Ç–æ', category: 'coat', primaryColor: 'beige', secondaryColor: null, season: 'winter', style: 'casual', material: 'wool', brand: null, imageUrl: null, status: 'active', createdAt: '2024-01-07T00:00:00Z' },\n  { id: 'g8', name: '–°–∏–≤ –ø—É–ª–æ–≤–µ—Ä', category: 'sweater', primaryColor: 'gray', secondaryColor: null, season: 'fall', style: 'casual', material: 'wool', brand: null, imageUrl: null, status: 'active', createdAt: '2024-01-08T00:00:00Z' },\n  { id: 'g9', name: '–ß–µ—Ä–≤–µ–Ω–∞ —Ä–æ–∫–ª—è', category: 'dress', primaryColor: 'red', secondaryColor: null, season: 'summer', style: 'formal', material: 'silk', brand: null, imageUrl: null, status: 'active', createdAt: '2024-01-09T00:00:00Z' },\n  { id: 'g10', name: '–ß–µ—Ä–Ω–∏ –æ–±—É–≤–∫–∏', category: 'shoes', primaryColor: 'black', secondaryColor: null, season: 'all_year', style: 'formal', material: 'leather', brand: null, imageUrl: null, status: 'active', createdAt: '2024-01-10T00:00:00Z' }\n];\n\nreturn [{ json: { data: garments, total: garments.length } }];"
      },
      "id": "get-garments",
      "name": "Get Garments",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 580]
    },
    {
      "parameters": {
        "jsCode": "const body = $input.first().json.body || {};\n\nif (!body.name || !body.category) {\n  return [{ json: { success: false, error: '–ò–º–µ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Å–∞ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏' } }];\n}\n\nconst newGarment = {\n  id: 'g_' + Date.now(),\n  name: body.name,\n  category: body.category,\n  primaryColor: body.primaryColor || 'black',\n  secondaryColor: body.secondaryColor || null,\n  season: body.season || 'all_year',\n  style: body.style || 'casual',\n  material: body.material || null,\n  brand: body.brand || null,\n  imageUrl: body.imageUrl || null,\n  status: 'active',\n  createdAt: new Date().toISOString()\n};\n\nreturn [{ json: { success: true, data: newGarment } }];"
      },
      "id": "create-garment",
      "name": "Create Garment",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 740]
    },
    {
      "parameters": {
        "jsCode": "const params = $input.first().json.params || {};\nconst garmentId = params.id;\n\nif (!garmentId) {\n  return [{ json: { success: false, error: 'ID –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ' } }];\n}\n\nreturn [{ json: { success: true, message: '–î—Ä–µ—Ö–∞—Ç–∞ –µ –∏–∑—Ç—Ä–∏—Ç–∞ —É—Å–ø–µ—à–Ω–æ', id: garmentId } }];"
      },
      "id": "delete-garment",
      "name": "Delete Garment",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 900]
    },
    {
      "parameters": {
        "jsCode": "// In-memory outfits storage\nconst garments = [\n  { id: 'g1', name: '–ë—è–ª–∞ —Ä–∏–∑–∞', category: 'shirt', primaryColor: 'white' },\n  { id: 'g2', name: '–°–∏–Ω–∏ –¥—ä–Ω–∫–∏', category: 'pants', primaryColor: 'blue' },\n  { id: 'g3', name: '–ß–µ—Ä–Ω–æ —Å–∞–∫–æ', category: 'jacket', primaryColor: 'black' },\n  { id: 'g4', name: '–ë—è–ª–∞ —Ç–µ–Ω–∏—Å–∫–∞', category: 'tshirt', primaryColor: 'white' },\n  { id: 'g5', name: '–ß–µ—Ä–Ω–∏ –ø–∞–Ω—Ç–∞–ª–æ–Ω–∏', category: 'pants', primaryColor: 'black' },\n  { id: 'g10', name: '–ß–µ—Ä–Ω–∏ –æ–±—É–≤–∫–∏', category: 'shoes', primaryColor: 'black' }\n];\n\nconst outfits = [\n  {\n    id: 'o1',\n    name: '–ë–∏–∑–Ω–µ—Å —Å—Ä–µ—â–∞',\n    occasion: 'business',\n    season: 'all_year',\n    notes: '–ü–µ—Ä—Ñ–µ–∫—Ç–Ω–æ –∑–∞ –æ—Ñ–∏—Ü–∏–∞–ª–Ω–∏ —Å—Ä–µ—â–∏',\n    wearCount: 5,\n    lastWorn: '2024-11-20T00:00:00Z',\n    items: [\n      { id: 'oi1', garmentId: 'g1', garment: garments[0] },\n      { id: 'oi2', garmentId: 'g5', garment: garments[4] },\n      { id: 'oi3', garmentId: 'g3', garment: garments[2] },\n      { id: 'oi4', garmentId: 'g10', garment: garments[5] }\n    ],\n    createdAt: '2024-01-15T00:00:00Z'\n  },\n  {\n    id: 'o2',\n    name: 'Casual —É–∏–∫–µ–Ω–¥',\n    occasion: 'casual',\n    season: 'all_year',\n    notes: '–ó–∞ —Ä–∞–∑—Ö–æ–¥–∫–∞ –∏–ª–∏ –∫–∞—Ñ–µ —Å –ø—Ä–∏—è—Ç–µ–ª–∏',\n    wearCount: 12,\n    lastWorn: '2024-11-28T00:00:00Z',\n    items: [\n      { id: 'oi5', garmentId: 'g4', garment: garments[3] },\n      { id: 'oi6', garmentId: 'g2', garment: garments[1] }\n    ],\n    createdAt: '2024-01-20T00:00:00Z'\n  },\n  {\n    id: 'o3',\n    name: 'Smart Casual',\n    occasion: 'smart_casual',\n    season: 'all_year',\n    notes: '–ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –µ–ª–µ–≥–∞–Ω—Ç–Ω–æ –∏ casual',\n    wearCount: 8,\n    lastWorn: '2024-11-25T00:00:00Z',\n    items: [\n      { id: 'oi7', garmentId: 'g1', garment: garments[0] },\n      { id: 'oi8', garmentId: 'g2', garment: garments[1] }\n    ],\n    createdAt: '2024-02-01T00:00:00Z'\n  }\n];\n\nreturn [{ json: { data: outfits, total: outfits.length } }];"
      },
      "id": "get-outfits",
      "name": "Get Outfits",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 1060]
    },
    {
      "parameters": {
        "jsCode": "const body = $input.first().json.body || {};\n\nif (!body.name) {\n  return [{ json: { success: false, error: '–ò–º–µ –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ' } }];\n}\n\nconst newOutfit = {\n  id: 'o_' + Date.now(),\n  name: body.name,\n  occasion: body.occasion || 'casual',\n  season: body.season || 'all_year',\n  notes: body.notes || null,\n  wearCount: 0,\n  lastWorn: null,\n  items: body.items || [],\n  createdAt: new Date().toISOString()\n};\n\nreturn [{ json: { success: true, data: newOutfit } }];"
      },
      "id": "create-outfit",
      "name": "Create Outfit",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 1220]
    },
    {
      "parameters": {
        "jsCode": "const params = $input.first().json.params || {};\nconst outfitId = params.id;\n\nif (!outfitId) {\n  return [{ json: { success: false, error: 'ID –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ' } }];\n}\n\nreturn [{ json: { success: true, message: '–¢–æ–∞–ª–µ—Ç—ä—Ç –µ –∏–∑—Ç—Ä–∏—Ç —É—Å–ø–µ—à–Ω–æ', id: outfitId } }];"
      },
      "id": "delete-outfit",
      "name": "Delete Outfit",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 1380]
    },
    {
      "parameters": {
        "jsCode": "// Prepare context for AI\nconst body = $input.first().json.body || {};\nconst message = body.message || '';\nconst context = body.context || {};\nconst sessionId = body.sessionId || 'session_' + Date.now();\n\n// Available garments in wardrobe\nconst garments = [\n  { name: '–ë—è–ª–∞ —Ä–∏–∑–∞', category: 'shirt', color: 'white', style: 'business_casual' },\n  { name: '–°–∏–Ω–∏ –¥—ä–Ω–∫–∏', category: 'pants', color: 'blue', style: 'casual' },\n  { name: '–ß–µ—Ä–Ω–æ —Å–∞–∫–æ', category: 'jacket', color: 'black', style: 'formal' },\n  { name: '–ë—è–ª–∞ —Ç–µ–Ω–∏—Å–∫–∞', category: 'tshirt', color: 'white', style: 'casual' },\n  { name: '–ß–µ—Ä–Ω–∏ –ø–∞–Ω—Ç–∞–ª–æ–Ω–∏', category: 'pants', color: 'black', style: 'formal' },\n  { name: '–°–∏–Ω—è —Ä–∏–∑–∞', category: 'shirt', color: 'blue', style: 'business_casual' },\n  { name: '–ë–µ–∂–æ–≤–æ –ø–∞–ª—Ç–æ', category: 'coat', color: 'beige', style: 'casual' },\n  { name: '–°–∏–≤ –ø—É–ª–æ–≤–µ—Ä', category: 'sweater', color: 'gray', style: 'casual' },\n  { name: '–ß–µ—Ä–≤–µ–Ω–∞ —Ä–æ–∫–ª—è', category: 'dress', color: 'red', style: 'formal' },\n  { name: '–ß–µ—Ä–Ω–∏ –æ–±—É–≤–∫–∏', category: 'shoes', color: 'black', style: 'formal' }\n];\n\nconst wardrobeList = garments.map(g => `- ${g.name} (${g.category}, ${g.color}, ${g.style})`).join('\\n');\n\nconst systemPrompt = `–¢–∏ —Å–∏ AI –º–æ–¥–µ–Ω —Å—Ç–∏–ª–∏—Å—Ç –Ω–∞ –∏–º–µ –°—Ç–µ–ª–∞. –û—Ç–≥–æ–≤–∞—Ä—è—à –°–ê–ú–û –Ω–∞ –±—ä–ª–≥–∞—Ä—Å–∫–∏ –µ–∑–∏–∫.\n\n–¢–≤–æ—è—Ç–∞ —Ä–æ–ª—è:\n- –ü–æ–º–∞–≥–∞—à –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏—Ç–µ –¥–∞ –∏–∑–±–µ—Ä–∞—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏ –¥—Ä–µ—Ö–∏ –∏ —Ç–æ–∞–ª–µ—Ç–∏ –æ—Ç —Ç–µ—Ö–Ω–∏—è –≥–∞—Ä–¥–µ—Ä–æ–±\n- –î–∞–≤–∞—à –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ —Å—ä–≤–µ—Ç–∏ –∑–∞ –∫–æ–º–±–∏–Ω–∏—Ä–∞–Ω–µ –Ω–∞ —Ü–≤–µ—Ç–æ–≤–µ –∏ —Å—Ç–∏–ª–æ–≤–µ\n- –°—ä–æ–±—Ä–∞–∑—è–≤–∞—à —Å–µ —Å –ø–æ–≤–æ–¥–∞, —Å–µ–∑–æ–Ω–∞ –∏ –≤—Ä–µ–º–µ—Ç–æ\n- –ü—Ä–µ–¥–ª–∞–≥–∞—à –ø—Ä–∞–∫—Ç–∏—á–Ω–∏ –∏ —Å—Ç–∏–ª–Ω–∏ —Ä–µ—à–µ–Ω–∏—è –æ—Ç –Ω–∞–ª–∏—á–Ω–∏—Ç–µ –¥—Ä–µ—Ö–∏\n\n–ì–∞—Ä–¥–µ—Ä–æ–± –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è:\n${wardrobeList}\n\n–¢–µ–∫—É—â–æ –≤—Ä–µ–º–µ: ${context.weather?.temp || 20}¬∞C\n\n–ü–†–ê–í–ò–õ–ê:\n1. –í–∏–Ω–∞–≥–∏ –∏–∑–ø–æ–ª–∑–≤–∞–π –¥—Ä–µ—Ö–∏ –æ—Ç –≥–æ—Ä–Ω–∏—è —Å–ø–∏—Å—ä–∫\n2. –§–æ—Ä–º–∞—Ç–∏—Ä–∞–π –æ—Ç–≥–æ–≤–æ—Ä–∏—Ç–µ —Å –µ–º–æ–¥–∂–∏—Ç–∞ –∏ markdown (bold, bullet points)\n3. –ë—ä–¥–∏ –ø—Ä–∏—è—Ç–µ–ª—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω/–∞\n4. –î–∞–≤–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –æ—Ç –≥–∞—Ä–¥–µ—Ä–æ–±–∞\n5. –ê–∫–æ –ø–∏—Ç–∞—Ç –∑–∞ –Ω–µ—â–æ –∏–∑–≤—ä–Ω –º–æ–¥–∞/–æ–±–ª–µ–∫–ª–æ, –ª—é–±–µ–∑–Ω–æ –ø—Ä–µ–Ω–∞—Å–æ—á–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ –∫—ä–º –º–æ–¥–Ω–∏ —Ç–µ–º–∏`;\n\nreturn [{\n  json: {\n    systemPrompt,\n    userMessage: message,\n    sessionId,\n    context\n  }\n}];"
      },
      "id": "prepare-ai-context",
      "name": "Prepare AI Context",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 1540]
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "gpt-4o-mini"
        },
        "messages": {
          "values": [
            {
              "role": "system",
              "content": "={{ $json.systemPrompt }}"
            },
            {
              "role": "user",
              "content": "={{ $json.userMessage }}"
            }
          ]
        },
        "options": {
          "maxTokens": 1000,
          "temperature": 0.7
        }
      },
      "id": "openai-chat",
      "name": "OpenAI Chat",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [740, 1540],
      "credentials": {
        "openAiApi": {
          "id": "openai-credentials",
          "name": "OpenAI API"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const input = $input.first().json;\nconst prevData = $('Prepare AI Context').first().json;\n\nlet message = '';\n\n// Handle different response formats\nif (input.message?.content) {\n  message = input.message.content;\n} else if (input.text) {\n  message = input.text;\n} else if (typeof input === 'string') {\n  message = input;\n} else {\n  // Fallback if OpenAI fails\n  message = `üëã **–ó–¥—Ä–∞–≤–µ–π—Ç–µ! –ê–∑ —Å—ä–º –°—Ç–µ–ª–∞, –≤–∞—à–∏—è—Ç AI —Å—Ç–∏–ª–∏—Å—Ç.**\n\n–ú–æ–≥–∞ –¥–∞ –≤–∏ –ø–æ–º–æ–≥–Ω–∞ —Å:\n\n‚Ä¢ üëî –ò–∑–±–æ—Ä –Ω–∞ —Ç–æ–∞–ª–µ—Ç –∑–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ –ø–æ–≤–æ–¥–∏\n‚Ä¢ üé® –ö–æ–º–±–∏–Ω–∏—Ä–∞–Ω–µ –Ω–∞ —Ü–≤–µ—Ç–æ–≤–µ\n‚Ä¢ üå§Ô∏è –°—ä–æ–±—Ä–∞–∑—è–≤–∞–Ω–µ —Å –≤—Ä–µ–º–µ—Ç–æ\n‚Ä¢ üíº –ü—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–µ–Ω dress code\n\n–ö–∞–∂–µ—Ç–µ –º–∏ –∑–∞ –∫–∞–∫—ä–≤ –ø–æ–≤–æ–¥ —Ç—ä—Ä—Å–∏—Ç–µ –¥—Ä–µ—Ö–∏!`;\n}\n\nreturn [{\n  json: {\n    success: true,\n    message: message,\n    sessionId: prevData.sessionId || 'session_' + Date.now()\n  }\n}];"
      },
      "id": "format-ai-response",
      "name": "Format AI Response",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [980, 1540]
    },
    {
      "parameters": {
        "jsCode": "const body = $input.first().json.body || {};\nconst occasion = (body.occasion || 'casual').toLowerCase();\nconst weather = body.weather || { temp: 20 };\nconst season = body.season || 'all_year';\n\nlet suggestion;\nlet items = [];\nlet tips = '';\n\nif (occasion.includes('business') || occasion.includes('formal') || occasion.includes('—Ä–∞–±–æ—Ç–∞') || occasion.includes('—Å—Ä–µ—â–∞')) {\n  items = ['–ë—è–ª–∞ —Ä–∏–∑–∞', '–ß–µ—Ä–Ω–∏ –ø–∞–Ω—Ç–∞–ª–æ–Ω–∏', '–ß–µ—Ä–Ω–æ —Å–∞–∫–æ', '–ß–µ—Ä–Ω–∏ –æ–±—É–≤–∫–∏'];\n  tips = '–ö–ª–∞—Å–∏—á–µ—Å–∫–∞—Ç–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –∑–∞ –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–Ω–∞ —Å—Ä–µ–¥–∞. –î–æ–±–∞–≤–µ—Ç–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω —á–∞—Å–æ–≤–Ω–∏–∫ –∑–∞ –∑–∞–≤—ä—Ä—à–µ–Ω –≤–∏–¥.';\n} else if (occasion.includes('party') || occasion.includes('–ø–∞—Ä—Ç–∏') || occasion.includes('–ø—Ä–∞–∑–Ω–∏–∫')) {\n  items = ['–ß–µ—Ä–≤–µ–Ω–∞ —Ä–æ–∫–ª—è', '–ß–µ—Ä–Ω–∏ –æ–±—É–≤–∫–∏'];\n  tips = '–°–º–µ–ª–∞ –∏ –µ–ª–µ–≥–∞–Ω—Ç–Ω–∞ –≤–∏–∑–∏—è –∑–∞ —Å–ø–µ—Ü–∏–∞–ª–Ω–∏ –ø–æ–≤–æ–¥–∏. –î–æ–±–∞–≤–µ—Ç–µ –∑–ª–∞—Ç–Ω–∏ –∞–∫—Å–µ—Å–æ–∞—Ä–∏.';\n} else if (weather.temp < 10) {\n  items = ['–°–∏–≤ –ø—É–ª–æ–≤–µ—Ä', '–ß–µ—Ä–Ω–∏ –ø–∞–Ω—Ç–∞–ª–æ–Ω–∏', '–ë–µ–∂–æ–≤–æ –ø–∞–ª—Ç–æ'];\n  tips = '–¢–æ–ø–ª–∞ –∏ —Å—Ç–∏–ª–Ω–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –∑–∞ —Å—Ç—É–¥–µ–Ω–∏—Ç–µ –¥–Ω–∏. –î–æ–±–∞–≤–µ—Ç–µ —à–∞–ª –∑–∞ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –∑–∞—â–∏—Ç–∞.';\n} else if (weather.temp > 25) {\n  items = ['–ë—è–ª–∞ —Ç–µ–Ω–∏—Å–∫–∞', '–°–∏–Ω–∏ –¥—ä–Ω–∫–∏'];\n  tips = '–õ–µ–∫–∞ –∏ —Å–≤–µ–∂–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –∑–∞ –≥–æ—Ä–µ—â–æ—Ç–æ –≤—Ä–µ–º–µ. –ò–∑–±–µ—Ä–µ—Ç–µ –¥–∏—à–∞—â–∏ –º–∞—Ç–µ—Ä–∏–∏.';\n} else {\n  items = ['–°–∏–Ω—è —Ä–∏–∑–∞', '–°–∏–Ω–∏ –¥—ä–Ω–∫–∏'];\n  tips = '–£–Ω–∏–≤–µ—Ä—Å–∞–ª–Ω–∞ casual –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –∑–∞ –≤—Å–µ–∫–∏ –¥–µ–Ω.';\n}\n\nsuggestion = {\n  name: `–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∑–∞ ${occasion}`,\n  occasion: occasion,\n  items: items,\n  tips: tips,\n  weather: `–ü—Ä–∏ ${weather.temp}¬∞C —Ç–∞–∑–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –µ –ø–æ–¥—Ö–æ–¥—è—â–∞.`,\n  season: season\n};\n\nreturn [{\n  json: {\n    success: true,\n    suggestion\n  }\n}];"
      },
      "id": "process-ai-suggest",
      "name": "Process AI Suggest",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [500, 1700]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Origin", "value": "*" },
              { "name": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
            ]
          }
        }
      },
      "id": "respond-register",
      "name": "Respond Register",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [740, 100]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Origin", "value": "*" },
              { "name": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
            ]
          }
        }
      },
      "id": "respond-login",
      "name": "Respond Login",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [740, 260]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Origin", "value": "*" },
              { "name": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
            ]
          }
        }
      },
      "id": "respond-me",
      "name": "Respond Me",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [740, 420]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Origin", "value": "*" },
              { "name": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
            ]
          }
        }
      },
      "id": "respond-garments",
      "name": "Respond Garments",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [740, 580]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Origin", "value": "*" },
              { "name": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
            ]
          }
        }
      },
      "id": "respond-create-garment",
      "name": "Respond Create Garment",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [740, 740]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Origin", "value": "*" },
              { "name": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
            ]
          }
        }
      },
      "id": "respond-delete-garment",
      "name": "Respond Delete Garment",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [740, 900]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Origin", "value": "*" },
              { "name": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
            ]
          }
        }
      },
      "id": "respond-outfits",
      "name": "Respond Outfits",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [740, 1060]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Origin", "value": "*" },
              { "name": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
            ]
          }
        }
      },
      "id": "respond-create-outfit",
      "name": "Respond Create Outfit",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [740, 1220]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Origin", "value": "*" },
              { "name": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
            ]
          }
        }
      },
      "id": "respond-delete-outfit",
      "name": "Respond Delete Outfit",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [740, 1380]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Origin", "value": "*" },
              { "name": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
            ]
          }
        }
      },
      "id": "respond-ai-chat",
      "name": "Respond AI Chat",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [1220, 1540]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseHeaders": {
            "entries": [
              { "name": "Access-Control-Allow-Origin", "value": "*" },
              { "name": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
              { "name": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
            ]
          }
        }
      },
      "id": "respond-ai-suggest",
      "name": "Respond AI Suggest",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [740, 1700]
    }
  ],
  "connections": {
    "Register Webhook": {
      "main": [[{ "node": "Process Register", "type": "main", "index": 0 }]]
    },
    "Process Register": {
      "main": [[{ "node": "Respond Register", "type": "main", "index": 0 }]]
    },
    "Login Webhook": {
      "main": [[{ "node": "Process Login", "type": "main", "index": 0 }]]
    },
    "Process Login": {
      "main": [[{ "node": "Respond Login", "type": "main", "index": 0 }]]
    },
    "Me Webhook": {
      "main": [[{ "node": "Process Me", "type": "main", "index": 0 }]]
    },
    "Process Me": {
      "main": [[{ "node": "Respond Me", "type": "main", "index": 0 }]]
    },
    "Get Garments Webhook": {
      "main": [[{ "node": "Get Garments", "type": "main", "index": 0 }]]
    },
    "Get Garments": {
      "main": [[{ "node": "Respond Garments", "type": "main", "index": 0 }]]
    },
    "Create Garment Webhook": {
      "main": [[{ "node": "Create Garment", "type": "main", "index": 0 }]]
    },
    "Create Garment": {
      "main": [[{ "node": "Respond Create Garment", "type": "main", "index": 0 }]]
    },
    "Delete Garment Webhook": {
      "main": [[{ "node": "Delete Garment", "type": "main", "index": 0 }]]
    },
    "Delete Garment": {
      "main": [[{ "node": "Respond Delete Garment", "type": "main", "index": 0 }]]
    },
    "Get Outfits Webhook": {
      "main": [[{ "node": "Get Outfits", "type": "main", "index": 0 }]]
    },
    "Get Outfits": {
      "main": [[{ "node": "Respond Outfits", "type": "main", "index": 0 }]]
    },
    "Create Outfit Webhook": {
      "main": [[{ "node": "Create Outfit", "type": "main", "index": 0 }]]
    },
    "Create Outfit": {
      "main": [[{ "node": "Respond Create Outfit", "type": "main", "index": 0 }]]
    },
    "Delete Outfit Webhook": {
      "main": [[{ "node": "Delete Outfit", "type": "main", "index": 0 }]]
    },
    "Delete Outfit": {
      "main": [[{ "node": "Respond Delete Outfit", "type": "main", "index": 0 }]]
    },
    "AI Chat Webhook": {
      "main": [[{ "node": "Prepare AI Context", "type": "main", "index": 0 }]]
    },
    "Prepare AI Context": {
      "main": [[{ "node": "OpenAI Chat", "type": "main", "index": 0 }]]
    },
    "OpenAI Chat": {
      "main": [[{ "node": "Format AI Response", "type": "main", "index": 0 }]]
    },
    "Format AI Response": {
      "main": [[{ "node": "Respond AI Chat", "type": "main", "index": 0 }]]
    },
    "AI Suggest Webhook": {
      "main": [[{ "node": "Process AI Suggest", "type": "main", "index": 0 }]]
    },
    "Process AI Suggest": {
      "main": [[{ "node": "Respond AI Suggest", "type": "main", "index": 0 }]]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 11,
  "updatedAt": "2025-12-04T00:00:00.000Z",
  "versionId": "final-v1"
}
